port: 3000
address: 0.0.0.0
metrics:
  port: 3001
  address: 0.0.0.0
  prefix: dynode
  user_agent_patterns:
    patterns:
      ios:
        - "Gem.*CFNetwork.*Darwin"
      android:
        - "okhttp/.*"
        - "Gem/Android.*"
        - "Gem/Android"

jwt:
  secret: ""

monitoring:
  enabled: false
  poll_interval: 10m
  max_sync_delay: 24s
  max_sync_blocks: 20
  adaptive:
    enabled: true
    window: 30s
    min_samples: 20
    error_threshold: 0.5
    recovery_threshold: 0.2
    cooldown: 45s
    min_switch_interval: 15s
    errors:
      status_codes: [429]
      error_messages:
        - "rate limit"

request:
  timeout: 3s

headers:
  forward:
    - content-type
    - content-encoding
    - content-length
  domains:
    public-eth.nownodes.io:
      - user-agent

retry:
  enabled: true
  max_attempts: 3
  errors:
    status_codes: [403, 429, 502, 503, 504]
    error_messages:
      - "daily request limit"
      - "rate limit"
      - "Unauthorized"

cache:
  max_memory_mb: 1024
  rules:
    ethereum:
      - rpc_method: eth_chainId
        ttl: 1h
    tron:
      - path: /wallet/getchainparameters
        method: GET
        ttl: 1d
      - path: /wallet/listwitnesses
        method: GET
        ttl: 1d
      - path: /wallet/getaccount
        method: POST
        inflight: true
      - path: /wallet/getaccountresource
        method: POST
        inflight: true
      - path: /wallet/getReward
        method: POST
        inflight: true
    solana:
      - rpc_method: getVoteAccounts
        ttl: 1h
    sui:
      - rpc_method: suix_getValidatorsApy
        ttl: 1h
      - rpc_method: suix_getLatestSuiSystemState
        ttl: 1m
    cosmos:
      - path: /cosmos/staking/v1beta1/validators
        method: GET
        ttl: 1d
    bitcoin:
      - path: /api/v2/block/**
        method: GET
        ttl: 0s
    hypercore:
      - path: /info
        method: POST
        ttl: 1h
        params:
          type: metaAndAssetCtxs
    aptos:
      - path: /v1/view
        method: POST
        ttl: 1h
        params:
          function: "0x1::delegation_pool::operator_commission_percentage"
